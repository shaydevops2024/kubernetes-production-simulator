# app/src/static/index.html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K8s Production Demo</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <!-- Modal Overlay -->
    <div id="modal-overlay" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Notification</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                Message here
            </div>
            <div class="modal-footer" id="modal-footer">
                <button class="btn btn-primary" onclick="closeModal()">OK</button>
            </div>
        </div>
    </div>

    <div class="app-container">
        <!-- Left Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h1>DevOps<br>Simulator</h1>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-item active" onclick="switchTab('dashboard')">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-text">Dashboard</span>
                </div>
                <div class="nav-item" onclick="switchTab('database')">
                    <span class="nav-icon">üóÑÔ∏è</span>
                    <span class="nav-text">StatefulSet-DB</span>
                </div>
                <div class="nav-item" onclick="switchTab('loadtest')">
                    <span class="nav-icon">‚ö°</span>
                    <span class="nav-text">HPA- Load Test</span>
                </div>
                <div class="nav-item" onclick="switchTab('logs')">
                    <span class="nav-icon">üìù</span>
                    <span class="nav-text">Logs</span>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div class="developer-info">
                    Developed by<br>
                    <strong>Shay Guedj</strong><br>
                    <button class="btn-profile" onclick="showDeveloperProfile()">Click Me</button>
                    DevOps Engineer
                </div>
            </div>
        </div>
        
        <!-- Main Content Area -->
        <div class="main-content">
            <div class="content-wrapper">
                <!-- Dashboard Tab -->
                <div id="dashboard-tab" class="tab-content active">
                    <div class="page-header-with-button">
                        <h2 class="page-title">System Status</h2>
                        <div class="refresh-control">
                            <label for="refresh-interval">Auto-refresh:</label>
                            <select id="refresh-interval" onchange="changeRefreshInterval()">
                                <option value="5">5 sec</option>
                                <option value="10">10 sec</option>
                                <option value="15">15 sec</option>
                                <option value="30">30 sec</option>
                                <option value="45">45 sec</option>
                                <option value="60">60 sec</option>
                                <option value="off">Off</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Cluster Stats Grid (Updated with two-column layout for Deployments) -->
                    <div class="cluster-stats-grid">
                        <div class="cluster-stat-box" onclick="showClusterDetails('deployments')">
                            <div class="deployment-stats-container">
                                <div class="deployment-stat-column">
                                    <div class="deployment-stat-label">Deployments</div>
                                    <div class="deployment-stat-value" id="cluster-deployments-count">-</div>
                                </div>
                                <div class="deployment-stat-column">
                                    <div class="deployment-stat-label">Ready</div>
                                    <div class="deployment-stat-value" id="cluster-deployments-ready">-</div>
                                </div>
                            </div>
                        </div>
                        <div class="cluster-stat-box" onclick="showClusterDetails('pods')">
                            <div class="cluster-stat-label">Pods</div>
                            <div class="cluster-stat-value" id="cluster-pods-count">-</div>
                            <div class="cluster-stat-sublabel" id="cluster-pods-ready">-</div>
                        </div>
                        <div class="cluster-stat-box" onclick="showClusterDetails('nodes')">
                            <div class="cluster-stat-label">Nodes</div>
                            <div class="cluster-stat-value" id="cluster-nodes-count">-</div>
                            <div class="cluster-stat-sublabel" id="cluster-nodes-status">-</div>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <h3>Application Info</h3>
                        <div class="status-item">
                            <span class="label">Environment</span>
                            <span class="value" id="app-env">Loading...</span>
                        </div>
                        <div class="status-item">
                            <span class="label">Application</span>
                            <span class="value" id="app-name">Loading...</span>
                        </div>
                        <div class="status-item">
                            <span class="label">Health Status</span>
                            <span class="badge badge-success" id="health-badge">‚úì Healthy</span>
                        </div>
                        <div class="status-item">
                            <span class="label">Readiness</span>
                            <span class="badge badge-success" id="ready-badge">‚úì Ready</span>
                        </div>
                        <div class="status-item">
                            <span class="label">Secret Configured</span>
                            <span class="badge" id="secret-badge">Loading...</span>
                        </div>
                    </div>
                    
                    <h3 class="section-title">Actions to test basic k8s behavior</h3>
                    
                    <!-- Action Buttons with Spacing -->
                    <div class="button-grid">
                        <button class="btn btn-danger" onclick="makeUnhealthy()">üíî Make Unhealthy</button>
                        <button class="btn btn-warning" onclick="simulateNotReady()">‚è∏Ô∏è Not Ready</button>
                        <button class="btn btn-primary" onclick="resetApp()">üîÑ Reset App</button>
                        <div style="width: 100%;"></div>
                        <button class="btn btn-secondary" onclick="showMonitoringCommands()">üìä Basic CLI Info Commands</button>
                    </div>
                    
                    <!-- CLI Commands Section (appears below grid) -->
                    <div id="cli-commands-container" class="cli-commands-container" style="display: none;">
                        <div class="cli-commands">
                            <h4 id="cli-commands-title">CLI Commands</h4>
                            <div id="cli-commands-list"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Database Tab -->
                <div id="database-tab" class="tab-content">
                    <div class="page-header-with-button">
                        <h2 class="page-title">Database Management</h2>
                        <button class="btn btn-secondary" onclick="window.open('/metrics', '_blank')">üìä Metrics</button>
                    </div>
                    
                    <div class="status-card">
                        <h3>Database Connection <span id="db-status-badge" class="badge badge-success">üü¢ Connected</span></h3>
                        <div class="status-item">
                            <span class="label">Database URL</span>
                            <span class="value" id="db-url">Loading...</span>
                        </div>
                        <div class="status-item">
                            <span class="label">Uses Secret</span>
                            <span class="value" id="db-secret-info">Loading...</span>
                        </div>
                        <div class="status-item">
                            <span class="label">Uses ConfigMap</span>
                            <span class="value" id="db-configmap-info">Loading...</span>
                        </div>
                    </div>
                    
                    <!-- Sticky Stats Section - 2 column grid -->
                    <div class="sticky-stats">
                        <h3 class="section-title">Database Statistics</h3>
                        <div class="stats-grid-two-col">
                            <div class="stat-card">
                                <h3>üë• Users</h3>
                                <div class="stat-value" id="users-count">0</div>
                                <div class="stat-label"><span id="active-users-count">0</span> active</div>
                            </div>
                            <div class="stat-card">
                                <h3>‚úì Tasks</h3>
                                <div class="stat-value" id="tasks-count">0</div>
                                <div class="stat-label"><span id="pending-tasks-count">0</span> pending</div>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="section-title">Add New Data to test the DB</h3>
                    <div class="form-grid">
                        <div class="form-section">
                            <h3>‚ûï Create New User</h3>
                            <form id="create-user-form">
                                <div class="form-group">
                                    <label>Username *</label>
                                    <input type="text" id="user-username" required placeholder="e.g., alice_dev">
                                </div>
                                <div class="form-group">
                                    <label>Email *</label>
                                    <input type="email" id="user-email" required placeholder="e.g., alice@example.com">
                                </div>
                                <div class="form-group">
                                    <label>Full Name *</label>
                                    <input type="text" id="user-fullname" required placeholder="e.g., Alice Johnson">
                                </div>
                                <button type="submit" class="btn btn-primary" style="width: 100%;">Create User</button>
                            </form>
                            <div id="user-success" class="success-message"></div>
                        </div>
                        
                        <div class="form-section">
                            <h3>‚ûï Create New Task</h3>
                            <form id="create-task-form">
                                <div class="form-group">
                                    <label>Assign to User *</label>
                                    <select id="task-user-id" required>
                                        <option value="">Loading users...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Title *</label>
                                    <input type="text" id="task-title" required placeholder="e.g., Deploy to production">
                                </div>
                                <div class="form-group">
                                    <label>Description</label>
                                    <textarea id="task-description" rows="3" placeholder="Task details..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Status *</label>
                                    <select id="task-status" required>
                                        <option value="pending" selected>‚è≥ Pending</option>
                                        <option value="in_progress">üîÑ In Progress</option>
                                        <option value="completed">‚úÖ Completed</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Priority *</label>
                                    <select id="task-priority" required>
                                        <option value="1" selected>üü¢ Low (1)</option>
                                        <option value="2">üü° Medium (2)</option>
                                        <option value="3">üî¥ High (3)</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary" style="width: 100%;">Create Task</button>
                            </form>
                            <div id="task-success" class="success-message"></div>
                        </div>
                    </div>
                    
                    <div id="cli-section" class="cli-commands" style="display: none;">
                        <h4>üîß Verify Your Changes via CLI</h4>
                        <div id="cli-commands-db-list"></div>
                    </div>
                    
                    <h3 class="section-title" id="users-section">Recent Users</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Username</th>
                                    <th>Email</th>
                                    <th>Full Name</th>
                                    <th>Tasks</th>
                                    <th>Status</th>
                                    <th>Created</th>
                                </tr>
                            </thead>
                            <tbody id="users-tbody">
                                <tr><td colspan="6" style="text-align: center;">Loading users...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h3 class="section-title" id="tasks-section">Recent Tasks</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>User</th>
                                    <th>Status</th>
                                    <th>Priority</th>
                                    <th>Created</th>
                                </tr>
                            </thead>
                            <tbody id="tasks-tbody">
                                <tr><td colspan="5" style="text-align: center;">Loading tasks...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" onclick="refreshDatabaseData()">üîÑ Refresh Data</button>
                        <button class="btn btn-secondary" onclick="exportDatabaseStats()">üì• Export Stats</button>
                    </div>
                </div>
                
                <!-- Load Test Tab -->
                <div id="loadtest-tab" class="tab-content">
                    <h2 class="page-title">HPA Load Testing</h2>
                    
                    <div class="status-card">
                        <h3>Load Test Control</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            Trigger horizontal pod autoscaling by generating CPU load. Watch pods scale from 2 to 10!
                        </p>
                        <div class="status-item">
                            <span class="label">Load Test Status</span>
                            <span id="load-status" class="badge badge-grey">Not Running</span>
                        </div>
                    </div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" onclick="startLoadTest()" id="start-load-btn">‚ö° Start Load Test</button>
                        <button class="btn btn-danger" onclick="stopLoadTest()" id="stop-load-btn" disabled>üõë Stop Load Test</button>
                    </div>
                    
                    <div class="cli-commands" style="margin-top: 20px;">
                        <h4>üìä Monitor Auto-Scaling</h4>
                        <div class="cli-command">
                            <code>kubectl get hpa -n k8s-multi-demo -w</code>
                            <button class="copy-btn" onclick="copyCommand(this)">üìã Copy</button>
                        </div>
                        <div class="cli-command">
                            <code>kubectl get pods -n k8s-multi-demo -w</code>
                            <button class="copy-btn" onclick="copyCommand(this)">üìã Copy</button>
                        </div>
                        <div class="cli-command">
                            <code>kubectl top pods -n k8s-multi-demo</code>
                            <button class="copy-btn" onclick="copyCommand(this)">üìã Copy</button>
                        </div>
                    </div>
                </div>
                
                <!-- Logs Tab -->
                <div id="logs-tab" class="tab-content">
                    <h2 class="page-title">Live Application Logs</h2>
                    
                    <div class="status-card">
                        <div class="log-viewer" id="log-viewer">Loading logs...</div>
                    </div>
                    
                    <div class="actions">
                        <button class="btn btn-primary" onclick="refreshLogs()">üîÑ Refresh Logs</button>
                        <button class="btn btn-secondary" onclick="clearLogs()">üóëÔ∏è Clear Display</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="/static/app.js"></script>
</body>
</html>